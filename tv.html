<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>StenoTV</title>
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background: radial-gradient(circle at center, #555 0%, #111 100%);
      color: #fff;
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
      box-shadow: inset 0 0 120px rgba(0,0,0,0.7);
         padding-top: 60px; 
    }

    header {
      background: linear-gradient(to bottom, #777, #333);
      width: 100%;
      padding: 1rem;
      text-align: center;
      font-size: 2rem;
      font-weight: bold;
      color: #f0f0f0;
      text-shadow: 2px 2px 3px #000;
      border-bottom: 4px solid #222;
      box-shadow: 0 6px 15px rgba(0,0,0,0.6);
    }

    #video-container {
      margin-top: 2rem;
      width: 90%;
      max-width: 820px;
      border: 16px solid #444;
      border-radius: 20px;
      background: linear-gradient(145deg, #222, #111);
      box-shadow: inset 0 0 40px rgba(0,0,0,0.9), 0 10px 40px rgba(0,0,0,0.8);
      overflow: hidden;
      position: relative;
    }

    video, iframe {
      width: 100%;
      height: 460px;
      border: none;
      background-color: #000;
      display: block;
    }

    #status {
      margin-top: 1rem;
      font-size: 1.2rem;
      color: #0f0;
      text-shadow: 1px 1px 2px #000;
    }

    footer {
      margin-top: auto;
      padding: 1rem;
      font-size: 0.9rem;
      color: #aaa;
      background-color: #222;
      width: 100%;
      text-align: center;
      border-top: 3px solid #444;
      box-shadow: 0 -4px 10px rgba(0,0,0,0.6);
    }

    @media (max-width: 600px) {
      video, iframe {
        height: 260px;
      }
    }
  </style>
  <script src="https://www.youtube.com/iframe_api"></script>
</head>
<body>
  
    
    <!-- Menu Bar, Do not remove--><div id="header-placeholder"></div> 
    
    <header> StenoTV</header>
  <div id="video-container">
    <div id="player"></div>
  </div>
  <div id="status">Checking schedule...</div>
  <footer>Â© 2025 Stenoip Company. All rights reserved.</footer>

  <script>
    var schedule = [
      {
        start: "10:25:00",
        end: "10:50:00",
        type: "youtube",
        url: "intro.mp4"
      },
      {
        start: "10:50:00",
        end: "11:00:00",
        type: "uploaded",
        url: "intro.mp4"
      }
    ];

    var fallbackVideo = {
      type: "uploaded",
      url: "videos/be-right-back.mp4"
    };

    var ytPlayer = null;

    function getCurrentTime() {
      var now = new Date();
      return now.toTimeString().slice(0, 8); // HH:MM:SS
    }

    function timeToSeconds(timeStr) {
      var parts = timeStr.split(":");
      return parseInt(parts[0]) * 3600 + parseInt(parts[1]) * 60 + parseInt(parts[2]);
    }

    function findScheduledVideo(currentTime) {
      var currentSeconds = timeToSeconds(currentTime);
      return schedule.find(function(item) {
        var start = timeToSeconds(item.start);
        var end = timeToSeconds(item.end);
        return currentSeconds >= start && currentSeconds < end;
      });
    }

    function extractYouTubeID(url) {
      var match = url.match(/(?:youtube\.com\/(?:embed\/|watch\?v=)|youtu\.be\/)([^\?&"'>]+)/);
      return match ? match[1] : null;
    }

    function loadVideo(video, offsetSeconds) {
      var container = document.getElementById("player");
      container.innerHTML = "";

      if (video.type === "youtube") {
        var videoId = extractYouTubeID(video.url);
        container.innerHTML = '<div id="ytplayer"></div>';
        window.onYouTubeIframeAPIReady = function () {
          ytPlayer = new YT.Player("ytplayer", {
            height: "460",
            width: "100%",
            videoId: videoId,
            playerVars: {
              autoplay: 1,
              start: offsetSeconds
            },
            events: {
              onReady: function () {
                document.getElementById("status").textContent = "YouTube video is now playing from " + Math.floor(offsetSeconds/60) + "m " + (offsetSeconds%60) + "s.";
              }
            }
          });
        };
      } else if (video.type === "live") {
        var iframe = document.createElement("iframe");
        iframe.src = video.url + "?autoplay=1";
        iframe.allow = "autoplay; encrypted-media";
        iframe.setAttribute("allowfullscreen", "true");
        container.appendChild(iframe);
        document.getElementById("status").textContent = "Live stream is now playing.";
      } else if (video.type === "uploaded") {
        var vid = document.createElement("video");
        vid.src = video.url;
        vid.controls = true;
        vid.autoplay = true;
        vid.muted = false; // not muted by default
        container.appendChild(vid);

        vid.addEventListener("canplay", function () {
          var safeTime = Math.min(offsetSeconds, vid.duration - 1);
          vid.currentTime = safeTime;
          document.getElementById("status").textContent = "Scheduled video is now playing from " + Math.floor(safeTime/60) + "m " + Math.floor(safeTime%60) + "s.";
        });
      }
    }

    function checkSchedule() {
      var currentTime = getCurrentTime();
      var video = findScheduledVideo(currentTime);
      if (video) {
        var offset = timeToSeconds(currentTime) - timeToSeconds(video.start);
        loadVideo(video, offset);
      } else {
        loadVideo(fallbackVideo, 0);
        document.getElementById("status").textContent = "No scheduled video. Showing standby video.";
      }
    }

    checkSchedule();
    setInterval(checkSchedule, 60000);
  </script>
     <script src="/load-header.js"></script>
</body>
</html>
